
%!TEX ROOT=ctutest.tex

\chapter{Goals and objectives}
The aim of this work is to create a collection of machine learning models, which
will be used in both, further research and image processing pipeline. The first
goal is to create a model which would be able to categorize different types of
ultrasound images, namely transversal, longitudinal and doppler ones. Further, 
we need to localize the common carotid artery (respectively internal carotid artery)
on the images of the first two named categories. As a last step, we need to
design a segmentation model which would segment three particular parts of
an artery with stenosis - vessel, lumen and plaque. Since all of these steps
in processing are interconnected and the outputs of one model are fed into a 
next one, all of the proposed methods need to achieve sufficient performance.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Background}

\section{Carotid Artery Stenosis}
To write.

\section{Medical ultrasound}
In general, medical ultrasound is a technique using sound waves in range etc.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Existing methods}

\section{Image Classification}
Image classification is one of the primary tasks in the field od image processing.
Its goal is to assing to an image one of predefined categories.
The neural network have achieved breakthrough in this field, namely ones using
convolutional layers. Later, as in many other domains, the deep learning has 
become state of the art in this field. One of the benchmark for this task is ImageNet 
Large Scale Visual Recognition Challenge \cite{russakovsky2015imagenet}, which has begun in 2010.
The task is to crate a model able to classify over 1.4 million images into one thousand 
categories. The size of the annotated dataset with the reduction of training time achieved by using GPU led
to deep architectures \cite{AlexNet}.

After inital successes of deep convolutional neural networks, they have been widely used
applied in many fields, inculuding medical and biology image processing. For example to 
predict breast cancer based on histopathological images \cite{BreastCNN}, to classify
lung pattern for interstitial lung diseases \cite{LungCNN} or to detect and classify
abnormalities on frontal chest radiographs \cite{ChestCNN}.


\subsection{VGG}
Very deep convolutional neural networks for large-scale image recognition \cite{VGG} were 
introduced in 2014, and it achieved both, first and second class in the Classification tracks of 
ImageNet Challenge \cite{IN2014} in the same year.


\subsubsection{Architecture}
Six architectures were introduced in the experiments, each containing six blocks of convolutional
layers separated by max-pooling ones. In the convolutional layers were used filters with
with size 3x3 (in one experiment were used filters with size 1x1 at the end of three convolutional blocks).
With the 3x3 convolutional filters is used stride 1 with zero padding, so the spatial dimensionality
is preserved trough whole block. In the max-pooling layer, a receptor field with size 2x2 is used and with stride 1 it 
reduces the dimensionality to half. Finally, there are three fully-connected layers. First two with 4096 neurons and
the last one with 1000 neuron followed by sigmoid activation function. The two best performing models with 16, respectively 19
layers are described by Figure TODO.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{ResNet}
The deep neural networks are generally harder to train \cite{HardDnn}. In 2015 was proposed ResNet\cite{ResNet}, 
a deep residual convolutional network. The depth of the networks was pushed even further, up to 152 layers. 
This combination resulted in the first place in the Categorization track of ImageNet Challenge 2015\cite{IN2015}
(ResNet models can be found under MSRA team name).

\subsubsection{Architecture}
The architectures of ResNet followes principles introduced in VGG, and uses mostly convolutional
layers with 3x3 filters, in some versions combined with 1x1 filters. ResNet takes an input of
size 224x224 pixels, which can be translated into 224x224x3 matrix. This input is than processed
by convolutional layer with filter size 7x7 and stride 2, which results in reduction of the 
dimension by two - to 112x112. The output of first layer is fed into only max-pooling layer,
with receptor filed 3x3 and stride 2. The following convolutional part is composed from four
blocks of convolutional layers, which structure varies by the specific network's version.
The dimensionality between convolutional blocks is reduced by increasing stride to two
in the first convolutional layer of a block, instead of using max-pooling, which is used in VGG.
Nerwork contains only on fully-connected layer, which is at the end and is followed by 
soft-max axtivation function, which translates the neorons' output to probabilities of the
one thousand categories.


\subsubsubsection{Residual learning}
The layes trough the neworks are not only connected with the previous ones, but 
they are connected with the residual connections as well. These shourtcuts help to
train such deep network and are based on the assumtion, that a network with these
connections should be able to fit the data as well as the shallower network without them.
TODO add images and describe deeply, add equations. 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Object Localization}
Object localization can be defined as a task to localize objects on an image. Usually
by surounding each one with a rectange TODO fig lara.

\section{From R-CNN to Faster R-CNN}
To write.


\subsection{Faster R-CNN}
To write.

\subsubsection{Architecture}
To write.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Segmentation}
To write.

\subsection{U-net}
To write.

\subsubsection{Architecture}
To write.

\subsubsection{Applications}
To write.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
